(function($){$.fn.rumble=function(opts,args){if(!opts){opts={};}var $self=this;var defaults={distance:4,shakes:3,speed:100,autoStart:true,onComplete:null,axis:'x',shrinkDistance:false,rumbleClass:'rumbling',position:'relative'};var settings=this.data('rumble');var methods={init:function(){settings=defaults;settings.origin=$self.position();methods.updateSettings(opts);var pos=$self.css('position');if(pos!='relative'||pos!='absolute'){$self.css('position',settings.position);}if(settings.autoStart){methods.rumble();}return $self;},updateSettings:function(opts){settings=$.extend(settings,opts);$self.data('rumble',settings);},rumble:function(args){if(args){methods.updateSettings(args);}var dest=0;var animateTo={};$self.addClass(settings.rumbleClass);for(var i=0;i<settings.shakes;i++){if(i%2==0){dest='+=';}else{dest='-=';}if(i==0){dest+=settings.distance.toString()+'px';}else{dest+=(settings.distance*2).toString()+'px';}if(settings.axis=='y'){animateTo={top:dest};}else{animateTo={left:dest};}$self.animate(animateTo,{queue:true,duration:settings.speed});if(settings.shrinkDistance&&settings.distance>1){settings.distance--;}}if(dest.charAt(0)=='+'){dest='-=';}else{dest='+=';}dest+=settings.distance.toString()+'px';if(settings.axis=='y'){animateTo={top:dest};}else{animateTo={left:dest};}$self.animate(animateTo,{queue:true,duration:settings.speed,complete:function(){if(settings.onComplete){settings.onComplete();}$self.position(settings.origin);$self.removeClass(settings.rumbleClass);}});return $self;},stop:function(){if($self.position!=$self.origin){$self.position(settings.origin);}$self.removeClass(settings.rumbleClass);$self.stop(true);return $self;}};if(typeof(opts)=='string'){if(optsinmethods){return methods[opts](args);}return $self;}return methods.init();}})(jQuery);
